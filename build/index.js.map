{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./src/component/attachment.field.js","webpack:///./src/index.js","webpack:///external {\"this\":[\"wp\",\"element\"]}"],"names":["compose","wp","data","withSelect","withDispatch","editor","MediaUpload","MediaUploadCheck","components","PanelBody","Button","Spinner","ResponsiveWrapper","ALLOWED_MEDIA_TYPES","META_KEY","AttachmentField","select","props","getMedia","getEditedPostAttribute","getCurrentPost","imageId","console","log","media","dispatch","onUpdateImage","image","editPost","meta","id","onRemoveImage","mediaWidth","mediaHeight","mediaSourceUrl","media_details","width","height","source_url","instructions","open","Fragment","element","registerPlugin","plugins","PluginSidebar","PluginSidebarMoreMenuItem","TextControl","Panel","TestField","setMetaFieldValue","value","fieldName","metaFieldValue","icon","render"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA;;AAEA,iC;;;;;;;;;;;;;;;;;;;;ICfQA,O,GAAYC,EAAE,CAACD,O,CAAfA,O;eAC6BC,EAAE,CAACC,I;IAAhCC,U,YAAAA,U;IAAYC,Y,YAAAA,Y;iBACsBH,EAAE,CAACI,M;IAArCC,W,cAAAA,W;IAAaC,gB,cAAAA,gB;qBACqCN,EAAE,CAACO,U;IAArDC,S,kBAAAA,S;IAAWC,M,kBAAAA,M;IAAQC,O,kBAAAA,O;IAASC,iB,kBAAAA,iB;AAEpC,IAAMC,mBAAmB,GAAG,CAAE,OAAF,CAA5B;AACA,IAAMC,QAAQ,GAAG,eAAjB;AAEO,IAAMC,eAAe,GAAGf,OAAO,CAEpCG,UAAU,CAAC,UAACa,MAAD,EAASC,KAAT,EAAmB;AAAA,gBACPD,MAAM,CAAC,MAAD,CADC;AAAA,MACpBE,QADoB,WACpBA,QADoB;;AAAA,iBAEsBF,MAAM,CAAC,aAAD,CAF5B;AAAA,MAErBG,sBAFqB,YAErBA,sBAFqB;AAAA,MAEGC,cAFH,YAEGA,cAFH;;AAG5B,MAAMC,OAAO,GAAGF,sBAAsB,CAAC,MAAD,CAAtB,CAA+BL,QAA/B,CAAhB;AACAQ,SAAO,CAACC,GAAR,CAAYH,cAAc,GAAG,MAAH,CAA1B;AACA,SAAO;AACLI,SAAK,EAAEH,OAAO,GAAGH,QAAQ,CAACG,OAAD,CAAX,GAAuB,IADhC;AAELA,WAAO,EAAPA;AAFK,GAAP;AAID,CATS,CAF0B,EAapCjB,YAAY,CAAC,UAACqB,QAAD,EAAWR,KAAX,EAAqB;AAChC,SAAO;AACLS,iBADK,yBACUC,KADV,EACkB;AACrBF,cAAQ,CAAC,aAAD,CAAR,CAAwBG,QAAxB,CAAiC;AAC/BC,YAAI,EAAE,iFAAGf,QAAL,EAAgBa,KAAK,CAACG,EAAtB;AAD2B,OAAjC;AAGD,KALI;AAMLC,iBANK,2BAMW;AACdN,cAAQ,CAAC,aAAD,CAAR,CAAwBG,QAAxB,CAAiC;AAC/BC,YAAI,EAAE,iFAAGf,QAAL,EAAgB,CAAhB;AAD2B,OAAjC;AAGD;AAVI,GAAP;AAYD,CAbW,CAbwB,CAAP,CA4B7B,gBAAsD;AAAA,MAAnDO,OAAmD,QAAnDA,OAAmD;AAAA,MAA1CK,aAA0C,QAA1CA,aAA0C;AAAA,MAA3BK,aAA2B,QAA3BA,aAA2B;AAAA,MAAZP,KAAY,QAAZA,KAAY;AACtD,MAAIQ,UAAJ;AACA,MAAIC,WAAW,GAAG,GAAlB;AACA,MAAIC,cAAJ;;AAEA,MAAKV,KAAL,EAAa;AACXQ,cAAU,GAAGR,KAAK,CAACW,aAAN,CAAoBC,KAAjC;AACAH,eAAW,GAAGT,KAAK,CAACW,aAAN,CAAoBE,MAAlC;AACAH,kBAAc,GAAGV,KAAK,CAACc,UAAvB;AACD;;AAED,MAAMC,YAAY,GAAG,gGAArB,CAXsD,CAatD;;AACA,SACE,yEAAC,SAAD;AACE,SAAK,EAAC,gBADR;AAEE,eAAW,EAAE;AAFf,KAIE,yEAAC,gBAAD;AAAkB,YAAQ,EAAGA;AAA7B,KACE,yEAAC,WAAD;AACE,SAAK,EAAC,UADR;AAEE,YAAQ,EAAEb,aAFZ;AAGE,gBAAY,EAAEb,mBAHhB;AAIE,cAAU,EAAC,qCAJb;AAKE,YAAQ,EAAE,KALZ;AAME,SAAK,EAAEQ,OANT;AAOE,UAAM,EAAE;AAAA,UAAGmB,IAAH,SAAGA,IAAH;AAAA,aACN,yEAAC,MAAD;AACE,iBAAS,EAAG,CAACnB,OAAD,GAAW,oCAAX,GAAkD,qCADhE;AAEE,eAAO,EAAGmB,IAFZ;AAGE,sBAAa,CAACnB,OAAD,GAAW,IAAX,GAAkB;AAHjC,SAKI,CAAC,CAACA,OAAF,IAAa,CAACG,KAAd,IAAuB,yEAAC,OAAD,OAL3B,EAMI,CAAC,CAACH,OAAF,IAAaG,KAAb,IACA,yEAAC,iBAAD;AACE,oBAAY,EAAGQ,UADjB;AAEE,qBAAa,EAAGC;AAFlB,SAIE;AAAK,WAAG,EAAGC,cAAX;AAA4B,WAAG,EAAC;AAAhC,QAJF,CAPJ,EAcI,CAACb,OAAD,IAAa,4GAdjB,CADM;AAAA;AAPV,IADF,CAJF,EAgCG,CAAC,CAACA,OAAF,IACC,yEAAC,gBAAD,QACE,yEAAC,MAAD;AAAQ,WAAO,EAAGU,aAAlB;AAAkC,UAAM,MAAxC;AAAyC,iBAAa;AAAtD,yBADF,CAjCJ,CADF;AA0CD,CApF8B,CAAxB,C;;;;;;;;;;;;;;;;;;;;ACRP;IAEQU,Q,GAAaxC,EAAE,CAACyC,O,CAAhBD,Q;IACAE,c,GAAmB1C,EAAE,CAAC2C,O,CAAtBD,c;mBAC6C1C,EAAE,CAAC2B,Q;IAAhDiB,a,gBAAAA,a;IAAeC,yB,gBAAAA,yB;qBACmB7C,EAAE,CAACO,U;IAArCuC,W,kBAAAA,W;IAAaC,K,kBAAAA,K;IAAOvC,S,kBAAAA,S;eACSR,EAAE,CAACC,I;IAAhCC,U,YAAAA,U;IAAYC,Y,YAAAA,Y;IACZJ,O,GAAYC,EAAE,CAACD,O,CAAfA,O;AAER,IAAMiD,SAAS,GAAGjD,OAAO,CACvBI,YAAY,CAAC,UAACqB,QAAD,EAAWR,KAAX,EAAqB;AAChC,SAAO;AACLiC,qBAAiB,EAAE,2BAACC,KAAD,EAAW;AAC5B1B,cAAQ,CAAE,aAAF,CAAR,CAA0BG,QAA1B,CACE;AAAEC,YAAI,EAAE,iFAAIZ,KAAK,CAACmC,SAAZ,EAAyBD,KAAzB;AAAN,OADF;AAGD;AALI,GAAP;AAOD,CARW,CADW,EAWvBhD,UAAU,CAAC,UAACa,MAAD,EAASC,KAAT,EAAmB;AAC5B,SAAO;AACLoC,kBAAc,EACZrC,MAAM,CAAE,aAAF,CAAN,CACGG,sBADH,CAC2B,MAD3B,EAEIF,KAAK,CAACmC,SAFV;AAFG,GAAP;AAMD,CAPS,CAXa,CAAP,CAmBhB,UAAAnC,KAAK;AAAA,SACL,yEAAC,SAAD;AACE,SAAK,EAAC,MADR;AAEE,eAAW,EAAE;AAFf,KAIE,yEAAC,WAAD;AACE,SAAK,EAAC,iBADR;AAEE,SAAK,EAAEA,KAAK,CAACoC,cAFf;AAGE,YAAQ,EAAEpC,KAAK,CAACiC;AAHlB,IAJF,CADK;AAAA,CAnBW,CAAlB;AAgCAP,cAAc,CAAC,MAAD,EAAS;AACrBW,MAAI,EAAE,kBADe;AAErBC,QAAM,EAAE;AAAA,WACN,yEAAC,QAAD,QACE,yEAAC,yBAAD;AACE,YAAM,EAAC,cADT;AAEE,UAAI,EAAC;AAFP,cADF,EAOE,yEAAC,aAAD;AACE,UAAI,EAAG,cADT;AAEE,UAAI,EAAG,YAFT;AAGE,WAAK,EAAG;AAHV,OAKE,yEAAC,KAAD,QACE,yEAAC,2EAAD;AAAiB,aAAO,EAAC;AAAzB,MADF,CALF,CAPF,CADM;AAAA;AAFa,CAAT,CAAd,C;;;;;;;;;;;ACzCA,aAAa,wCAAwC,EAAE,I","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","const { compose } = wp.compose\r\nconst { withSelect, withDispatch } = wp.data\r\nconst { MediaUpload, MediaUploadCheck } = wp.editor\r\nconst { PanelBody, Button, Spinner, ResponsiveWrapper } = wp.components\r\n\r\nconst ALLOWED_MEDIA_TYPES = [ 'image' ]\r\nconst META_KEY = 'inky_webcomic'\r\n\r\nexport const AttachmentField = compose(\r\n\r\n  withSelect((select, props) => {\r\n    const { getMedia } = select('core')\r\n\t  const { getEditedPostAttribute, getCurrentPost } = select('core/editor')\r\n    const imageId = getEditedPostAttribute('meta')[META_KEY]\r\n    console.log(getCurrentPost()['meta'])\r\n    return {\r\n      media: imageId ? getMedia(imageId) : null,\r\n      imageId,\r\n    }\r\n  }),\r\n\r\n  withDispatch((dispatch, props) => {\r\n    return {\r\n      onUpdateImage( image ) {\r\n        dispatch('core/editor').editPost({\r\n          meta: { [META_KEY]: image.id }\r\n        });\r\n      },\r\n      onRemoveImage() {\r\n        dispatch('core/editor').editPost({\r\n          meta: { [META_KEY]: 0 }\r\n        });\r\n      },\r\n    }\r\n  })\r\n\r\n)(({ imageId, onUpdateImage, onRemoveImage, media }) => {\r\n  let mediaWidth\r\n  let mediaHeight = 200\r\n  let mediaSourceUrl\r\n\r\n  if ( media ) {\r\n    mediaWidth = media.media_details.width\r\n    mediaHeight = media.media_details.height\r\n    mediaSourceUrl = media.source_url\r\n  }\r\n\r\n  const instructions = <p>You can't</p>\r\n\r\n  // todo: loading and stuff\r\n  return (\r\n    <PanelBody \r\n      title=\"Add Attachment\"\r\n      initialOpen={true}\r\n    >\r\n      <MediaUploadCheck fallback={ instructions }>\r\n        <MediaUpload\r\n          title=\"Webcomic\"\r\n          onSelect={onUpdateImage}\r\n          allowedTypes={ALLOWED_MEDIA_TYPES}\r\n          modalClass='editor-post-inky-image__media-modal'\r\n          multiple={false}\r\n          value={imageId}\r\n          render={({ open }) => (\r\n            <Button\r\n              className={ !imageId ? 'editor-post-featured-image__toggle' : 'editor-post-featured-image__preview' }\r\n              onClick={ open }\r\n              aria-label={ !imageId ? null : 'Edit or update the image' }\r\n            >\r\n              { !!imageId && !media && <Spinner /> }\r\n              { !!imageId && media &&\r\n                <ResponsiveWrapper\r\n                  naturalWidth={ mediaWidth }\r\n                  naturalHeight={ mediaHeight }\r\n                >\r\n                  <img src={ mediaSourceUrl } alt=\"\" />\r\n                </ResponsiveWrapper>\r\n              }\r\n              { !imageId && (<span>Set webcomic image</span>) }\r\n            </Button>\r\n          )}\r\n        />\r\n      </MediaUploadCheck>\r\n      {!!imageId &&\r\n        <MediaUploadCheck>\r\n          <Button onClick={ onRemoveImage } isLink isDestructive>\r\n            Remove Attachment\r\n          </Button>\r\n        </MediaUploadCheck>\r\n      }\r\n    </PanelBody>\r\n  )\r\n})\r\n","import { AttachmentField } from './component/attachment.field'\r\n\r\nconst { Fragment } = wp.element \r\nconst { registerPlugin } = wp.plugins\r\nconst { PluginSidebar, PluginSidebarMoreMenuItem } = wp.editPost\r\nconst { TextControl, Panel, PanelBody } = wp.components\r\nconst { withSelect, withDispatch } = wp.data\r\nconst { compose } = wp.compose \r\n\r\nconst TestField = compose(\r\n  withDispatch((dispatch, props) => {\r\n    return {\r\n      setMetaFieldValue: (value) => {\r\n        dispatch( 'core/editor' ).editPost(\r\n          { meta: { [ props.fieldName ]: value } }\r\n        )\r\n      }\r\n    }\r\n  }),\r\n  \r\n  withSelect((select, props) => {\r\n    return { \r\n      metaFieldValue: \r\n        select( 'core/editor' )\r\n          .getEditedPostAttribute( 'meta' )\r\n          [ props.fieldName ],\r\n    }\r\n  })\r\n)(props => \r\n  <PanelBody\r\n    title=\"Test\"\r\n    initialOpen={true}\r\n    >\r\n    <TextControl\r\n      label=\"Test Meta Field\"\r\n      value={props.metaFieldValue}\r\n      onChange={props.setMetaFieldValue}\r\n    ></TextControl>\r\n  </PanelBody>\r\n)\r\n\r\nregisterPlugin('inky', {\r\n  icon: 'admin-customizer',\r\n  render: () => \r\n    <Fragment>\r\n      <PluginSidebarMoreMenuItem\r\n        target=\"inky-sidebar\"\r\n        icon=\"admin-customizer\"\r\n      >\r\n        Inky\r\n      </PluginSidebarMoreMenuItem>\r\n      <PluginSidebar\r\n        name = \"inky-sidebar\"\r\n        icom = \"admin-post\"\r\n        title = \"Inky\"\r\n      >\r\n        <Panel>\r\n          <AttachmentField metaKey=\"inky_webcomic\" />\r\n        </Panel>\r\n      </PluginSidebar>\r\n    </Fragment>\r\n})\r\n","(function() { module.exports = this[\"wp\"][\"element\"]; }());"],"sourceRoot":""}